<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>go ä½¿ç”¨ sqlite3</title>
    <link rel="stylesheet" href="/res/css/style.css">
</head>
<body>
<nav class="main-nav">
  <ul>
    <li><a href="/blog">blog</a></li>
    <li><a href="/archive">archive</a></li>
    <li><a href="/design">design</a></li>
    <li><a href="/rss">rss</a></li>
  </ul>
</nav>
<h2>å®‰è£… sqlite3</h2>
<blockquote>
<p>åœ¨ arch æºé‡Œï¼Œmysql è¢«æ›¿æ¢æˆäº† mariadbï¼Œæ²¡åŠ›æ°”æŠ˜è…¾äº†<!--more-->ï¼Œä¹Ÿä¸æƒ³æ±¡æŸ“ manjaro çš„ç¯å¢ƒï¼Œæ‰€ä»¥åœ¨ windows ä¸Šè£…äº† mysql æ¥è¿œç¨‹è¿æ¥ï¼Œä½†æ˜¯è¿œç¨‹è¿æ¥çš„é€Ÿåº¦æ…¢çš„æ„Ÿäººï¼Œå› ä¸ºè¦åšç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å®è·µè¯¾ä½œä¸šï¼Œæˆ‘æ—¢ä¸æƒ³æ‹¿ä¸¤å°ç”µè„‘å»ï¼Œä¹Ÿä¸æƒ³åœ¨ manjaro ä¸Šè£…ä¸€ä¸ªåå¤§çš„æ•°æ®åº“æ¥è€—ç”µï¼Œæœ€åæˆ‘è§‰å¾—åº”è¯¥è¯•ä¸€ä¸‹æ˜¯æœ€è½»é‡çš„ sqlite3</p>
</blockquote>
<p>one line</p>
<pre><code class="language-bash">$ sudo pacman -S sqlite3
</code></pre>
<h2>ä½¿ç”¨ sqlite3</h2>
<blockquote>
<p>å’Œå…¶ä»–å…³ç³»å‹æ•°æ®åº“ä¸åŒçš„æ˜¯ï¼ŒSQLiteæ²¡æœ‰å•ç‹¬çš„æœåŠ¡å™¨è¿›ç¨‹ï¼Œä»¥ä¾›å®¢æˆ·ç«¯ç¨‹åºè®¿é—®å¹¶æä¾›ç›¸å…³çš„æœåŠ¡ã€‚SQLiteä½œä¸ºä¸€ç§åµŒå…¥å¼æ•°æ®åº“ï¼Œå…¶è¿è¡Œç¯å¢ƒä¸ä¸»ç¨‹åºä½äºåŒä¸€è¿›ç¨‹ç©ºé—´ï¼Œå› æ­¤å®ƒä»¬ä¹‹é—´çš„é€šä¿¡å®Œå…¨æ˜¯è¿›ç¨‹å†…é€šä¿¡ï¼Œè€Œç›¸æ¯”äºè¿›ç¨‹é—´é€šä¿¡ï¼Œå…¶æ•ˆç‡æ›´é«˜ã€‚ç„¶è€Œéœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œè¯¥ç§ç»“æ„åœ¨å®é™…è¿è¡Œæ—¶ç¡®å®å­˜åœ¨ä¿æŠ¤æ€§è¾ƒå·®çš„é—®é¢˜ï¼Œæ¯”å¦‚æ­¤æ—¶ï¼Œåº”ç”¨ç¨‹åºå‡ºç°é—®é¢˜å¯¼è‡´è¿›ç¨‹å´©æºƒï¼Œç”±äºSQLiteä¸å…¶æ‰€ä¾èµ–çš„è¿›ç¨‹ä½äºåŒä¸€è¿›ç¨‹ç©ºé—´ï¼Œé‚£ä¹ˆæ­¤æ—¶SQLiteä¹Ÿå°†éšä¹‹é€€å‡ºã€‚ä½†æ˜¯å¯¹äºç‹¬ç«‹çš„æœåŠ¡å™¨è¿›ç¨‹ï¼Œåˆ™ä¸ä¼šæœ‰æ­¤é—®é¢˜ï¼Œå®ƒä»¬å°†åœ¨å¯†é—­æ€§æ›´å¥½çš„ç¯å¢ƒä¸‹å®Œæˆå®ƒä»¬çš„å·¥ä½œã€‚</p>
</blockquote>
<p>å®‰è£…å®Œä¹‹åï¼Œåœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ <code>sqlite3</code> å°±èƒ½è¿›å…¥ sqlite çš„ç•Œé¢äº†ï¼Œsqlite3 çš„å‘½ä»¤éƒ½æ˜¯ç”¨ <code>.</code> å¼€å¤´ï¼Œè¯¦è§ <code>.help</code> ï¼Œä¸‹æ–‡å¹¶ä¸ä¼šå¯¹å‘½ä»¤åšè¯¦ç»†ä»‹ç»ï¼Œæˆ‘è®¤ä¸ºæ²¡å¿…è¦å»è®°ä½ï¼Œç”¨çš„æ—¶å€™æŸ¥ä¸€ä¸‹è¡¨å°±è¡Œäº†ï¼Œåªè¦æŒæ¡å‡ ä¸ªå¸¸ç”¨çš„æŒ‡ä»¤å°±è¡Œ</p>
<p><strong>åˆ›å»ºæ•°æ®åº“</strong></p>
<p>åœ¨è¿›å…¥ sqlite ç•Œé¢å‰å¯ä»¥æŒ‡å®šä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœè¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨çš„è¯ï¼Œè¿›å…¥ç•Œé¢ä¹‹åè¾“å…¥ <code>.database</code> ä¼šä¿å­˜åˆ°æœ¬åœ°ï¼Œä¹‹åä½¿ç”¨ <code>.quit</code> é€€å‡º sqlite ç•Œé¢æŸ¥çœ‹</p>
<pre><code class="language-bash">$ sqlite3 test1.db
SQLite version 3.40.0 2022-11-16 12:10:08
Enter &quot;.help&quot; for usage hints.
sqlite&gt; .database
main: /home/paradox/workspace/go/src/trysqlite3/test1.db r/w
sqlite&gt; .quit
$ ls
test1.db
</code></pre>
<p>ä¹Ÿå¯ä»¥åœ¨è¿›å…¥ sqlite åï¼Œç”¨ <code>.open</code> è¿›è¡Œç­‰ä»·çš„æ“ä½œï¼Œä½†è¿™æ—¶å€™ä¸éœ€è¦ <code>.database</code> å°±èƒ½ä¿å­˜åˆ°æœ¬åœ°</p>
<pre><code class="language-bash">$ sqlite3
SQLite version 3.40.0 2022-11-16 12:10:08
Enter &quot;.help&quot; for usage hints.
Connected to a transient in-memory database.
Use &quot;.open FILENAME&quot; to reopen on a persistent database.
sqlite&gt; .open test.db
sqlite&gt; .quit
$ ls
test.db
</code></pre>
<h2>gorm è¿æ¥</h2>
<p><a href="https://gorm.io/zh_CN/docs/connecting_to_the_database.html#SQLite">ğŸ”—</a> gorm çš„å®˜æ–¹æ–‡æ¡£æœ‰æ¼”ç¤ºï¼Œç”±äº sqlite æ˜¯åŸºäºæ–‡ä»¶çš„ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦ä¸€å †å¤æ‚çš„è¿æ¥å‚æ•°</p>
<pre><code class="language-go">package main
import (
    &quot;gorm.io/gorm&quot;
    &quot;gorm.io/driver/sqlite&quot;
)

func main() {
    db, err := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Config{})
}
</code></pre>
<p><strong>æµ‹è¯•å»ºè¡¨</strong></p>
<p>è¿™é‡Œä½¿ç”¨ gorm çš„ <code>AutoMigrate</code> æ–¹æ³•</p>
<pre><code class="language-go">type File struct {
    Id int
    Filename string
    CreateDate time.Time
}

func main() {
    db, _ := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Cofing{})
    db.AutoMigrate(&amp;File{})
}
</code></pre>
<p><code>.table</code> æŸ¥çœ‹æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ï¼Œ<code>.schema</code> æŸ¥çœ‹æŒ‡å®šè¡¨çš„å­—æ®µ</p>
<pre><code class="language-bash">$ sqlite3 test.db
SQLite version 3.40.0 2022-11-16 12:10:08
Enter &quot;.help&quot; for usage hints.
sqlite&gt; .tables
files
sqlite&gt; .schema files
CREATE TABLE `files` (`id` integer,`filename` text,`create_date` datetime,PRIMARY KEY (`id`));
</code></pre>
<p>æ²¡é—®é¢˜ï¼Œé‚£ gorm çš„å…¶ä»–æ–¹æ³•åº”è¯¥éƒ½èƒ½ç”¨äº†</p>
<p>æœ€åæ¥æµ‹è¯•ä¸€ä¸‹å¢å°±ç»“æŸå§</p>
<pre><code class="language-go">db.Create(&amp;File{Filename: &quot;nice&quot;, CreateData: time.Now()})
</code></pre>
<p>æ•°æ®åº“å½“ç„¶æ”¯æŒ sql è¯­å¥ï¼Œæˆ‘ä»¬æ¥æŸ¥çœ‹è¡¨</p>
<pre><code class="language-bash">sqlite&gt; select * from files;
1|nice|2023-01-28 21:14:31.440692473+08:00|
</code></pre>
<p>å…¶ä¸­ id æ˜¯è‡ªå¢ä¸»é”®ï¼Œæ‰€ä»¥èƒ½è‡ªåŠ ï¼Œå¯ä»¥çœ‹åˆ°éå¸¸å®Œç¾ï¼Œæˆ‘ç›¸ä¿¡ sqlite ä¸€å®šéå¸¸å¥½ç”¨</p>
<p>ä¹‹åå¯èƒ½ä¼šé‡åˆ°å‘ï¼Œåšå¥½å¿ƒç†å‡†å¤‡</p>
<blockquote>
<p>è²Œä¼¼åå°è¦å¼€ä¸€ä¸ª <code>sqlite3 test.db</code> æ‰èƒ½å“åº”ï¼Œä¸ç„¶ orm ä¼šé˜»å¡</p>
<p>è¯´å®è¯ï¼Œæ‡’äººçš„ orm è®©æˆ‘æœ‰ç‚¹ä¸èˆ’æœï¼Œä¸‹å­¦æœŸè¿˜æ˜¯è¦ç³»ç»Ÿæ€§å­¦ä¹ ä¸€ä¸‹ sql è¯­å¥å•Šï¼Œä¸€æ–¹é¢ä¸ºäº†çµæ´»ï¼Œå¦ä¸€æ–¹é¢é¢è¯•è‚¯å®šè¿˜è¦ç”¨å•Š ...</p>
</blockquote>

<footer>
  <ul>
    <li class="left">&copy; 2025 paradoxskin.</li>
    <li><a href="/blog">blog</a></li>
    <li><a href="/archive">archive</a></li>
    <li><a href="/design">design</a></li>
    <li><a href="/rss">rss</a></li>
  </ul>
</footer>
<script src="/res/js/main.js" defer></script>
</body>
</html>