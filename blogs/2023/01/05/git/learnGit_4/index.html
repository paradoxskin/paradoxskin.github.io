<!DOCTYPE html>
<html id="all">

<head>
	<meta charset="utf-8">

















<link rel="shortcut icon" href="/pic/favicon.ico">
	<title>Paradoxless | Blogs</title>
	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="/css/font.css">

	
<link rel="stylesheet" href="/lib/highlight/rainbow.min.css">

<meta name="generator" content="Hexo 6.3.0"></head>
	
<script src="/lib/highlight/highlight.min.js"></script>

	
<script src="/lib/highlight/highlightjs-line-numbers.js"></script>

	
<script src="/lib/jquery.js"></script>

	
<script src="/lib/jquery.pjax.js"></script>

	
<script src="/js/main.js"></script>

<body id="lybody">
	<div id="head">
	<a id="pLogo" href="/"><img alt="P" src="/pic/logo.svg"></a>
	<div id="urlText">aradoxskin.</div>
	<a id="githubLogo" href="https://github.com/paradoxskin" target="_blank"><img alt="github" src="/pic/github.svg"></a>
	<div id="urlText">.io</div>
	<div id="sucklessText">- simple is best</div>
	<div id="clear"></div>
</div>

	<hr id="hidden">
	<script>
	//if(localStorage.getItem('bgs')==null){
		localStorage['bgs']='comp'

			localStorage.setItem('bgs[num]','25');

			localStorage.setItem('bgs[pic1]','/pic/wp/01.jpg');

			localStorage.setItem('bgs[pic2]','/pic/wp/02.jpg');

			localStorage.setItem('bgs[pic3]','/pic/wp/03.jpg');

			localStorage.setItem('bgs[pic4]','/pic/wp/04.jpg');

			localStorage.setItem('bgs[pic5]','/pic/wp/05.jpg');

			localStorage.setItem('bgs[pic6]','/pic/wp/06.jpg');

			localStorage.setItem('bgs[pic7]','/pic/wp/07.jpg');

			localStorage.setItem('bgs[pic8]','/pic/wp/08.jpg');

			localStorage.setItem('bgs[pic9]','/pic/wp/09.jpg');

			localStorage.setItem('bgs[pic10]','/pic/wp/10.jpg');

			localStorage.setItem('bgs[pic11]','/pic/wp/11.jpg');

			localStorage.setItem('bgs[pic12]','/pic/wp/12.jpg');

			localStorage.setItem('bgs[pic13]','/pic/wp/13.png');

			localStorage.setItem('bgs[pic14]','/pic/wp/14.png');

			localStorage.setItem('bgs[pic15]','/pic/wp/15.png');

			localStorage.setItem('bgs[pic16]','/pic/wp/16.jpg');

			localStorage.setItem('bgs[pic17]','/pic/wp/17.jpg');

			localStorage.setItem('bgs[pic18]','/pic/wp/18.jpg');

			localStorage.setItem('bgs[pic19]','/pic/wp/19.jpg');

			localStorage.setItem('bgs[pic20]','/pic/wp/20.jpg');

			localStorage.setItem('bgs[pic21]','/pic/wp/21.png');

			localStorage.setItem('bgs[pic22]','/pic/wp/22.jpg');

			localStorage.setItem('bgs[pic23]','/pic/wp/23.png');

			localStorage.setItem('bgs[pic24]','/pic/wp/24.jpg');

			localStorage.setItem('bgs[pic25]','/pic/wp/25.jpg');

		if(localStorage.getItem('now')==null){
			localStorage.setItem('now','pic22');
		}
	//}
</script>

<div id="nav">
	<ul>
		<li><button id="cgBg" onclick="randomSwitch()">O</button><button id="clBg" onclick="noBg()">_</button></li>

		<iframe id="music-player" frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=110 src="//music.163.com/outchain/player?type=0&id=7669623816&auto=0&height=90"></iframe>

		<button id="nav-hide" onclick="hideMenu()">â—¤</button>

		<span id="clear"></span>
	</ul>
</div>
<button id="nav-show" onclick="showMenu()">â—¢</button>

<span id="pup">
	<div id="menu">
	
	
		
			<b><a href="/" class="menu-item-link" id="in">Home</a></b>
		
	
		
			<b><a data-pjax="#main" href="/blogs" class="menu-item-link-selected" id="in">Blogs</a></b>
		
	
		
			<b><a href="/archives" class="menu-item-link" id="in">Archives</a></b>
		
	
		
			<b><a href="/about" class="menu-item-link" id="in">who@mi</a></b>
		
	
		
			<b><a href="/links" class="menu-item-link" id="in">Links</a></b>
		
	
	<div id="outlink">
	
		<a href="https://www.lexaloffle.com/pico-8.php" class="menu-item-link" id="out" target="_blank">pico-8</a>
	
		<a href="https://suckless.org/" class="menu-item-link" id="out" target="_blank">suckless</a>
	
	</div>
</div>

	<div id="main">
		<div id="post">

	<b><div id="start-title">git å­¦ä¹ ç¬”è®° 4</div></b>

	
	<center><b><span id="start-date">start at 2023/01/04.</span></b></center>
	

    <h2 id="æ‹†æ‰ä¹‹å‰çš„æäº¤"><a href="#æ‹†æ‰ä¹‹å‰çš„æäº¤" class="headerlink" title="æ‹†æ‰ä¹‹å‰çš„æäº¤"></a>æ‹†æ‰ä¹‹å‰çš„æäº¤</h2><h3 id="ä½¿ç”¨-reset"><a href="#ä½¿ç”¨-reset" class="headerlink" title="ä½¿ç”¨ reset"></a>ä½¿ç”¨ <code>reset</code></h3><p>å¼€å‘è¿‡ç¨‹ä¸­éš¾å…æœ‰å¯¹ä¹‹å‰çš„ commit åæ‚”çš„æƒ…å†µï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨ <code>git reset</code> å‘½ä»¤æ¥åšåˆ°ï¼Œä½†æ˜¯<span id="more"></span> Reset å‘½ä»¤çš„æ„æ€å¾ˆå®¹æ˜“è®©äººè¯¯è§£</p>
<p>ç”±äºé‡å¯ä¹‹å <code>/tmp</code> æ–‡ä»¶å¤¹è¢«æ¸…ç©ºäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å†å¼€ä¸€ä¸ªæ–°çš„æœ¬åœ°ä»“åº“ï¼Œéšä¾¿å†™ç‚¹ commit</p>
<pre><code class="bash">$ ls
tmp.txt
$ cat tmp.txt
line 1
line 2
line 3
line 4
line 5
line 6
$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
</code></pre>
<p>æ¯æ¬¡ commit éƒ½æ˜¯åŠ ä¸Šä¸€è¡Œ line</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹ <code>git reset</code> ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ‹†æ‰æœ€åä¸€æ¬¡çš„ commit ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ç›¸å¯¹ï¼Œä¸€ç§æ˜¯ç»å¯¹</p>
<p>ç›¸å¯¹æŒ‡çš„å°±æ˜¯ç›¸å¯¹äºå‚æ•°ä¸­çš„ commitï¼Œæˆ‘ä»¬æƒ³è¦å‰å¾€å‰é¢å“ªä¸ª commit</p>
<pre><code class="bash">$ git reset 8c7e150^
Unstaged changes after reset:
M       tmp.txt
$ git log --oneline
280fc06 (HEAD -&gt; master) cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
</code></pre>
<p>å¯ä»¥çœ‹åˆ° <code>git reset 8c7e150^</code> ä¹‹å HEAD æŒ‡é’ˆæŒ‡åœ¨äº†å‰ä¸€æ¬¡çš„ commit ä¸Šï¼Œ<code>^</code> ä»£è¡¨å‰ä¸€æ¬¡ï¼Œæ‰€ä»¥ <code>8c7e150^</code> å°±ä»£è¡¨æœ€åä¸€æ¡ commit çš„å‰ä¸€æ¬¡ commitï¼ŒåŒæ ·çš„é“ç†ï¼Œå¦‚æœä½ è¦å€’é€€åˆ°ä¸¤æ¬¡å‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥ <code>79b0d45^^</code>ã€‚å†å¾€ä¸Šï¼Œå¦‚æœä½ è¦å›åˆ°ç¬¬5æ¬¡ï¼Œæ‰“ä½ï¼Œä¸è¦å†™ <code>8c7e150^^^^^</code> ï¼Œè¿˜æœ‰ä¸€ç§ç®€ä¾¿å†™æ³•ï¼Œ<code>8c7e150~5</code>ï¼Œ ç­‰ä»·äº <code>8c7e150^^^^^</code>ã€‚SHA-1å¯ä»¥ä»£è¡¨ä¸€æ¬¡ commitï¼Œä½†æ˜¯è€æ˜¯ç”¨ SHA-1 å¯èƒ½è§‰å¾—æœ‰ç‚¹éº»çƒ¦ï¼Œä¹Ÿä¸å¥½è®°ï¼Œå¯ä»¥ç”¨ <code>HEAD</code> æˆ–è€… åˆ†æ”¯å ä»£æŒ‡å½“å‰çš„åˆ†æ”¯æ‰€åœ¨çš„ commitï¼Œ<code>git reset HEAD^</code> æˆ–è€… <code>git reset master^</code> ç­‰ä»·äºä¸Šé¢çš„<code>git reset 8c7e150^</code></p>
<p>ä¸Šé¢æ˜¯ç›¸å¯¹æ–¹æ³•ï¼Œè¿˜ç®—æ–¹ä¾¿ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹ç¨å¾®éº»çƒ¦ç‚¹çš„ç»å¯¹æ–¹æ³•</p>
<p>ç»å¯¹å°±æ˜¯çŸ¥é“æˆ‘ä»¬çš„ç›®æ ‡çš„åœ°ç‚¹ï¼Œç›´æ¥å‰å¾€é‚£é‡Œ</p>
<pre><code class="bash">$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ git reset e353c79
Unstaged changes after reset:
M       tmp.txt
$ git log --oneline
e353c79 (HEAD -&gt; master) cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
</code></pre>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘è¾“å…¥çš„ SHA-1 å¯¹åº”çš„æ˜¯ç¬¬å››æ¡ commitï¼Œ<code>git reset</code> åæˆ‘ä»¬å°±åœ¨é‚£ä¸€æ¬¡ commit äº†ï¼ŒåŒæ ·çš„é“ç†ï¼Œå¦‚æœä½ è¾“å…¥çš„æ˜¯å…¶ä»– commit çš„ SHA-1 ä¹Ÿå¯ä»¥å‰å¾€é‚£æ¡ commit</p>
<p>è¿™æ—¶å€™ä½ å¯ä»¥å¼€å§‹å¥½å¥‡äº†ï¼Œæ—¢ç„¶ commit è¢«æ‹†æ‰äº†ï¼Œé‚£ä¹ˆæ‹†å‡ºæ¥çš„æ–‡ä»¶éƒ½æ²¡äº†å—ï¼Œè¿™ä¸ªé—®é¢˜å°±å’Œ <code>reset</code> çš„æ¨¡å¼æœ‰å…³ç³»äº†</p>
<h3 id="reset-çš„æ¨¡å¼"><a href="#reset-çš„æ¨¡å¼" class="headerlink" title="reset çš„æ¨¡å¼"></a><code>reset</code> çš„æ¨¡å¼</h3><p><code>git reset</code> æœ‰ä¸‰ç§æ¨¡å¼ï¼Œ<code>mixed</code>, <code>soft</code>, <code>hard</code></p>
<p>è¿™ä¸‰ç§æ¨¡å¼ä¹‹é—´æœ‰ç»†å¾®çš„åŒºåˆ«</p>
<p><strong><code>mixed</code> æ¨¡å¼</strong></p>
<p>è¿™ä¸ªæ¨¡å¼æ˜¯é»˜è®¤çš„å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šæ¨¡å¼çš„å‚æ•°ï¼Œ<code>git reset</code> éƒ½ä¼šä½¿ç”¨è¿™ä¸ªæ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä¸‹ä¼šæŠŠæš‚å­˜åŒºçš„æ–‡ä»¶åˆ é™¤ï¼Œä½†æ˜¯ä¸ä¼šå½±å“å·¥ä½œç›®å½•çš„æ–‡ä»¶</p>
<pre><code class="bash">$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ git reset HEAD^ --mixed
Unstaged changes after reset:
M       tmp.txt
$ git status
On branch master
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
        modified:   tmp.txt

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
$ cat tmp.txt
line 1
line 2
line 3
line 4
line 5
line 6
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ <code>mixed</code> æ¨¡å¼ <code>reset</code> ä¹‹å <code>tmp.txt</code> çš„æ–‡æœ¬å†…å®¹æ²¡æœ‰å›åˆ°ç¬¬äº”æ¬¡ commit çš„çŠ¶æ€ï¼Œè¯´æ˜æˆ‘ä»¬å·¥ä½œåŒºçš„æ–‡ä»¶æ²¡æœ‰å˜åŒ–ã€‚ä½†æ˜¯ <code>git status</code> æé†’æˆ‘ä»¬ <code>tmp.txt</code> ç›¸å¯¹äºæš‚å­˜åŒºçš„ <code>tmp.txt</code> å‘ç”Ÿäº†æ”¹å˜ï¼Œè¯´æ˜æš‚å­˜åŒºè¢«è¿˜åŸæˆäº†ç¬¬äº”æ¬¡ commit çš„çŠ¶æ€</p>
<p><strong><code>soft</code> æ¨¡å¼</strong></p>
<p>ä½¿ç”¨ <code>soft</code> æ¨¡å¼éœ€è¦åŠ ä¸Š <code>--soft</code> å‚æ•°ï¼Œ<code>soft</code> æ¨¡å¼ä¸‹å·¥ä½œç›®å½•å’Œæš‚å­˜åŒºçš„æ–‡ä»¶éƒ½ä¸ä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥çœ‹èµ·æ¥åªæœ‰ HEAD çš„ä½ç½®ç§»åŠ¨äº†è€Œå·²ï¼Œcommit è¢«æ‹†å¼€çš„éƒ¨åˆ†ä¼šè¢«ç›´æ¥æ”¾åœ¨æš‚å­˜åŒº</p>
<pre><code class="bash">$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ git status
On branch master
nothing to commit, working tree clean
$ git reset HEAD^ --soft
$ git log --oneline
280fc06 (HEAD -&gt; master) cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ cat tmp.txt
line 1
line 2
line 3
line 4
line 5
line 6
$ git status
On branch master
Changes to be committed:
  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)
        modified:   tmp.txt
</code></pre>
<p>ä¸Šé¢ <code>reset</code> åˆ°å‰ä¸€æ¬¡ commit ä¹‹åï¼Œ<code>tmp.txt</code> æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå·¥ä½œç›®å½•ä¼šè¢«ä¿ç•™ï¼Œå†æ¥çœ‹æš‚å­˜åŒºï¼Œæš‚å­˜åŒºæ˜¯å‡†å¤‡ commit çš„çŠ¶æ€ï¼Œæ²¡æœ‰æ£€æµ‹åˆ°æ”¹åŠ¨ï¼Œæ‰€ä»¥æš‚å­˜åŒºä¹Ÿæ²¡æœ‰è¢«åˆ é™¤</p>
<p><strong><code>hard</code> æ¨¡å¼</strong></p>
<p>è¿™ä¸ªæ¨¡å¼å°±æ˜¯å½»åº•çš„å›æº¯ï¼Œå·¥ä½œç›®å½•å’Œæš‚å­˜åŒºçš„æ–‡ä»¶éƒ½ä¼šè¢«åˆ é™¤</p>
<pre><code class="bash">$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ git reset --hard HEAD^
HEAD is now at 280fc06 cmt 5
$ git log --oneline
280fc06 (HEAD -&gt; master) cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ cat tmp.txt
line 1
line 2
line 3
line 4
line 5
$ git status
On branch master
nothing to commit, working tree clean
</code></pre>
<p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„æœ€åä¸€è¡Œ <code>line 6</code> è¢«åˆ é™¤äº†ï¼Œå˜æˆäº†ç¬¬äº”æ¬¡çš„çŠ¶æ€ï¼Œæš‚å­˜åŒºä¹Ÿè¢«åˆ é™¤äº†ï¼Œæ˜¾ç¤ºæ— äº‹å¯åšï¼Œæ‰€ä»¥å°±æ˜¯å¯ä»¥çœ‹æˆæ—¶é—´å®Œå…¨å›æº¯åˆ°äº†ç¬¬äº”æ¬¡ commit çš„æ—¶å€™</p>
<h3 id="åæ‚”-reset-äº†"><a href="#åæ‚”-reset-äº†" class="headerlink" title="åæ‚” reset äº†"></a>åæ‚” <code>reset</code> äº†</h3><p>åæ‚”ä¹‹å‰ä½¿ç”¨çš„ <code>reset</code> äº†ï¼Œè¿˜èƒ½è¿˜åŸä¹‹å‰çš„ commit å—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬éœ€è¦æ ‘ç«‹ä¸€ä¸ªè§‚å¿µï¼Œä¸ç®¡ç”¨ä»€ä¹ˆæ¨¡å¼è¿›è¡Œ <code>reset</code>ï¼Œcommit ä¸ä¼šå› ä¸º <code>reset</code> å°±é©¬ä¸Šæ¶ˆå¤±</p>
<pre><code class="bash">$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
$ git reset HEAD~2
Unstaged changes after reset:
M       tmp.txt
$ git log --oneline
e353c79 (HEAD -&gt; master) cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
</code></pre>
<p>ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨ <code>soft</code> æ¨¡å¼ <code>reset</code> åˆ°äº†ç¬¬å››æ¬¡ commit çš„åœ°æ–¹ï¼Œä¸‹é¢æˆ‘æ¥æ¼”ç¤ºå¦‚ä½•å›åˆ°ç¬¬å…­æ¬¡ commit</p>
<pre><code class="bash">$ git reset 8c7e150 --hard
HEAD is now at 8c7e150 cmt 6
$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e cmt 3
4e4acae commit 2
ed641db commit 1
</code></pre>
<p>ä½¿ç”¨ç»å¯¹æ–¹æ³•ï¼ŒæŒ‡å‘ç¬¬å…­æ¬¡ commit çš„ SHA-1 å°±èƒ½å›åˆ°ç¬¬å…­æ¬¡ commit äº†ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è¿™æ ·å¾ˆéº»çƒ¦ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç”¨ç›¸å¯¹æ–¹æ³•ï¼Œé‚£æ˜¯å› ä¸º git çš„é€»è¾‘æ˜¯ç±»ä¼¼æ ‘çš„ç»“æ„</p>
<p><img src="http://parad0xpic.oss-cn-hangzhou.aliyuncs.com/image-for-pyup/gittree202315ed.png" alt="gittree202315ed"></p>
<p>æ¯ä¸ª commit éƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸Šå›¾ä¸­æ¯ä¸ªç‚¹éƒ½æ˜¯ commitï¼Œéƒ½æŒ‡å‘ä»–ä»¬å‰é¢ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç”±å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ª commit ä¸Šèƒ½è¡ç”Ÿå‡ºä¸åŒçš„åˆ†æ”¯ï¼Œæ‰€ä»¥å½“å‰èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹çš„å…³ç³»æ˜¯ä¸€å¯¹å¤šçš„ï¼Œå› æ­¤ commit æ˜¯æ— æ³•è®°å½•åç»§èŠ‚ç‚¹çš„ä¿¡æ¯çš„ï¼Œä½†æ˜¯å¾€å‰çš„èŠ‚ç‚¹æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ <code>^</code> è¿™ç§ç¬¦å·æ¥å¿«é€Ÿå®šä½ï¼Œæ‰€ä»¥è¿™æ˜¯å¿…è¦çš„éº»çƒ¦ã€‚åƒä¸Šå›¾ä¸­å¦‚æœ è¿˜èƒ½åŠ ä¸€ä¸ªç¬¦å·æŒ‡å‘åç»§èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å›åˆ°å·¦è¾¹çš„èŠ‚ç‚¹è¿˜æ˜¯å³è¾¹çš„èŠ‚ç‚¹å‘¢ï¼Œè¿™å°±äº§ç”Ÿäº†çŸ›ç›¾</p>
<p>é‚£å¦‚æœæˆ‘ä»¬ <code>reset</code> ä¹‹å‰æ²¡æœ‰è®°å½•ä¹‹å‰çš„ SHA-1 æ€ä¹ˆåŠï¼Œå…¶å®æ²¡æœ‰å…³ç³»ï¼Œgit ä¸­çš„ <code>reflog</code> æŒ‡ä»¤å¯ä»¥ä¿ç•™ä¸€äº›è®°å½•ï¼Œè¿™äº›è®°å½•ä¸Šå°±æœ‰ SHA-1 ä¿¡æ¯</p>
<pre><code class="bash">$ git reset HEAD~3 --hard
HEAD is now at 4b6168e cmt 3
$ git reflog
4b6168e (HEAD -&gt; master) HEAD@&#123;0&#125;: reset: moving to HEAD~3
8c7e150 HEAD@&#123;1&#125;: reset: moving to 8c7e150
e353c79 HEAD@&#123;2&#125;: reset: moving to HEAD~2
8c7e150 HEAD@&#123;3&#125;: reset: moving to HEAD
8c7e150 HEAD@&#123;4&#125;: reset: moving to 8c7e150
280fc06 HEAD@&#123;5&#125;: reset: moving to HEAD^
8c7e150 HEAD@&#123;6&#125;: reset: moving to 8c7e150
280fc06 HEAD@&#123;7&#125;: reset: moving to HEAD^
8c7e150 HEAD@&#123;8&#125;: reset: moving to 8c7e150
280fc06 HEAD@&#123;9&#125;: reset: moving to HEAD^
8c7e150 HEAD@&#123;10&#125;: reset: moving to 8c7e150
280fc06 HEAD@&#123;11&#125;: reset: moving to HEAD^
8c7e150 HEAD@&#123;12&#125;: reset: moving to 8c7e150
280fc06 HEAD@&#123;13&#125;: reset: moving to HEAD^
8c7e150 HEAD@&#123;14&#125;: reset: moving to 8c7e150
e353c79 HEAD@&#123;15&#125;: reset: moving to e353c79
e353c79 HEAD@&#123;16&#125;: reset: moving to e353c79
e353c79 HEAD@&#123;17&#125;: reset: moving to e353c79
8c7e150 HEAD@&#123;18&#125;: reset: moving to 8c7e150
280fc06 HEAD@&#123;19&#125;: reset: moving to 8c7e150^
8c7e150 HEAD@&#123;20&#125;: commit: cmt 6
280fc06 HEAD@&#123;21&#125;: commit: cmt 5
e353c79 HEAD@&#123;22&#125;: commit: cmt 4
4b6168e (HEAD -&gt; master) HEAD@&#123;23&#125;: commit: cmt 3
4e4acae HEAD@&#123;24&#125;: commit: commit 2
ed641db HEAD@&#123;25&#125;: commit (initial): commit 1
</code></pre>
<p>å½“HEADç§»åŠ¨æ—¶ï¼Œéƒ½ä¼šåœ¨ <code>reflog</code> ä¸­ç•™ä¸‹è®°å½•ï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¹‹å‰ commit çš„ SHA-1 çš„å€¼æ˜¯ <code>8c7e150</code>ï¼Œæƒ³è¦å›å»è¾“å…¥è¿™ä¸² SHA-1 å³å¯ï¼Œé™¤äº†ä½¿ç”¨ <code>git reflog</code>ï¼Œ<code>git log -g --oneline</code> ä¹Ÿèƒ½åšåˆ°ä¸€æ ·çš„æ•ˆæœ</p>
<blockquote>
<p>ğŸ’¡ ä¸è¦è¢« <code>reset</code> çš„è‹±æ–‡æ„æ€ç»™è¯¯å¯¼äº†ï¼Œå®ƒé€šå¸¸è¢«ç¿»è¯‘æˆé‡æ–°è®¾ç½®ï¼Œä½†æ˜¯åœ¨ git ä¸­ï¼Œå®ƒçš„æ„æ€åº”è¯¥æ˜¯ å‰å¾€ æˆ–è€… å˜æˆï¼Œé‚£äº›æ¶ˆå¤±çš„ commit å¹¶ä¸ä¼šå› ä¸º <code>reset</code> è€Œæ¶ˆå¤±ï¼Œè¢«è®°å½•è¿‡çš„ä¸œè¥¿åªæ˜¯æš‚æ—¶æ¶ˆå¤±äº†ï¼Œä½†æ˜¯éšæ—¶éƒ½å¯ä»¥æ•‘å›æ¥</p>
</blockquote>
<blockquote>
<p>âš  æ³¨æ„ï¼Œgit åªä¼šè®°å½•æš‚å­˜åŒºå’Œå†å²ä»“åº“ï¼Œå¦‚æœä½ å½“å‰ä»£ç æ²¡æœ‰ <code>git add</code> å’Œ <code>git commit</code> é‚£ä½  <code>reset</code> çš„æ—¶å€™éœ€è¦å°å¿ƒäº†ï¼Œéœ€è¦è®°ä½ä¸åŒ <code>reset</code> æ¨¡å¼ä¸‹å¯¹å·¥ä½œç›®å½•å’Œæš‚å­˜åŒºçš„å½±å“ï¼Œå¦åˆ™ä¼šå¯¼è‡´ git æ²¡æœ‰ç®¡æ§åˆ°çš„æ–‡ä»¶ä¸¢å¤±ï¼å½“ç„¶è¿˜æ˜¯åº”è¯¥å…ˆ <code>git commit</code> äº†ä¹‹åå† <code>reset</code></p>
</blockquote>
<h2 id="HEAD-æ˜¯ä»€ä¹ˆ"><a href="#HEAD-æ˜¯ä»€ä¹ˆ" class="headerlink" title="HEAD æ˜¯ä»€ä¹ˆ"></a>HEAD æ˜¯ä»€ä¹ˆ</h2><p>æˆ‘æŠŠ HEAD å½“æˆä¸€ä¸ªæŒ‡é’ˆï¼ˆä¹¦ä¸Šè¯´æ˜¯æŒ‡æ ‡ï¼Œä½†è¿™ä¸ªæŒ‡æ ‡æœ‰æ­§ä¹‰ï¼‰ï¼ŒæŒ‡å‘æŸä¸€ä¸ªåˆ†æ”¯ï¼Œé€šå¸¸å¯ä»¥æŠŠå®ƒå½“ä½œ å½“å‰æ‰€åœ¨çš„åˆ†æ”¯ï¼Œåœ¨ <code>.git</code> æ–‡ä»¶å¤¹é‡Œå°±æœ‰ <code>HEAD</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é‡Œé¢æ˜¯ä»€ä¹ˆå†…å®¹</p>
<pre><code class="bash">$ cat .git/HEAD
ref: refs/heads/master
</code></pre>
<p>å®ƒæŒ‡å‘å½“å‰åˆ†æ”¯çš„ masterï¼Œå¯ä»¥çœ‹åˆ° master ä¹Ÿå¯¹åº”äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ master ä¸Šæœ‰ä»€ä¹ˆå†…å®¹</p>
<pre><code class="bash">$ cat .git/refs/heads/master
4b6168ef584743ebb557fc768da29c509665687e
</code></pre>
<p>å‘ç°æ˜¯ä¸€ä¸ªå¥‡æ€ªçš„æ–‡ä»¶</p>
<p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œcheckout è¿‡å»çœ‹çœ‹ <code>HEAD</code> ä¼šæœ‰ä»€ä¹ˆå˜åŒ–</p>
<pre><code class="bash">$ git branch cat
$ git branch
  cat
* master
$ git checkout cat
Switched to branch &#39;cat&#39;
$ cat .git/HEAD
ref: refs/heads/cat
</code></pre>
<p>å‘ç°å®ƒæŒ‡å‘äº† <code>refs/heads/cat</code> ï¼Œæ‰€ä»¥ HEAD ä¼šåœ¨åˆ‡æ¢åˆ†æ”¯çš„æ—¶å€™æ”¹å˜ï¼Œè€Œé€šå¸¸ä¼šæŒ‡å‘å½“å‰æ‰€åœ¨çš„åˆ†æ”¯ï¼Œä¸è¿‡ HEAD ä¹Ÿä¸ä¸€å®šæ€»æ˜¯ä¼šæŒ‡å‘æŸä¸ªåˆ†æ”¯ï¼Œå½“ HEAD æ²¡æœ‰æŒ‡å‘åˆ†æ”¯çš„æ—¶å€™ä¾¿ä¼šé€ æˆ detached HEAD çš„çŠ¶æ€ï¼Œåé¢ä¼šè®²åˆ°</p>
<p>åˆ‡æ¢åˆ†æ”¯çš„åŒæ—¶ï¼ŒHEADçš„å†…å®¹ä¼šæ”¹å˜ï¼Œå½“ HEAD çš„å†…å®¹æ”¹å˜çš„æ—¶å€™ï¼ŒReflog ä¹Ÿä¼šç•™ä¸‹è®°å½•</p>
<h2 id="åªæäº¤æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹"><a href="#åªæäº¤æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹" class="headerlink" title="åªæäº¤æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹"></a>åªæäº¤æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹</h2><p>å‡è®¾æˆ‘ä»¬å½“å‰æ˜¯ä¸‹é¢è¿™ä¸ªçŠ¶æ€</p>
<pre><code class="bash">$ git log --oneline
8c7e150 (HEAD -&gt; master) cmt 6
280fc06 cmt 5
e353c79 cmt 4
4b6168e (cat) cmt 3
4e4acae commit 2
ed641db commit 1
$ git status
On branch master
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
        modified:   tmp.txt

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
$ cat tmp.txt
line 1
line 2
line 3
line 4
line 5
line 6
sercert 1
sercert 2
sercert 3
line 7
</code></pre>
<p>æˆ‘æƒ³ commit ä¸€ä¸ª cmt 7 ä½†æ˜¯æˆ‘åªæƒ³æŠŠ <code>line 7</code> æäº¤ä¸Šå»ï¼Œé‚£ä¸‰è¡Œ <code>sercert</code> æˆ‘ä¸æƒ³æäº¤ï¼Œè¿™æ—¶å€™è¦æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>è¾“å…¥ <code>git add -p tmp.txt</code>ï¼Œgit å°±ä¼šè¯¢é—®æ˜¯å¦å°†è¿™ä¸ªåŒºåŸŸåŠ åˆ°æš‚å­˜åŒº</p>
<pre><code class="bash">$ git add -p .
diff --git a/tmp.txt b/tmp.txt
index f985857..c24d9f7 100644
--- a/tmp.txt
+++ b/tmp.txt
@@ -4,3 +4,7 @@ line 3
 line 4
 line 5
 line 6
+sercert 1
+sercert 2
+sercert 3
+line 7
(1/1) Stage this hunk [y,n,q,a,d,e,?]?
</code></pre>
<p>å‘ç°æœ‰å¾ˆå¤šé€‰é¡¹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœ‰ä»€ä¹ˆé€‰é¡¹</p>
<pre><code class="bash"># y æš‚å­˜å½“å‰åŒºåŸŸ
y - stage this hunk
# n ä¸æš‚å­˜å½“å‰åŒºåŸŸ
n - do not stage this hunk
# q é€€å‡ºï¼Œä¸æš‚å­˜è¿™ä¸ªåŒºåŸŸå’Œä¹‹åçš„æ‰€æœ‰åŒºåŸŸ
q - quit; do not stage this hunk or any of the remaining ones
# a æš‚å­˜å½“å‰åŒºåŸŸå’Œä¹‹åçš„è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰åŒºåŸŸ
a - stage this hunk and all later hunks in the file
# d ä¸æš‚å­˜å½“å‰åŒºåŸŸå’Œä¹‹åçš„è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰åŒºåŸŸ
d - do not stage this hunk or any of the later hunks in the file
# e æ‰‹åŠ¨ç¼–è¾‘å½“å‰åŒºåŸŸ
e - manually edit the current hunk
? - print help
</code></pre>
<p>æˆ‘ä»¬è¦è‡ªå®šä¹‰é‚£å°±å›ç­” <code>e</code> </p>
<pre><code class="bash">  1 # Manual hunk edit mode -- see bottom for a quick guide.
  2 @@ -4,3 +4,7 @@ line 3
  3  line 4
  4  line 5
  5  line 6
  6 +sercert 1
  7 +sercert 2
  8 +sercert 3
  9 +line 7
 10 # ---
 11 # To remove &#39;-&#39; lines, make them &#39; &#39; lines (context).
 12 # To remove &#39;+&#39; lines, delete them.
 13 # Lines starting with # will be removed.
 14 # If the patch applies cleanly, the edited hunk will immediatel    y be marked for staging.
 15 # If it does not apply cleanly, you will be given an opportunit    y to
 16 # edit again.  If all lines of the hunk are removed, then the e    dit is
 17 # aborted and the hunk is left unchanged.
</code></pre>
<p>è·³å‡º vim ç¼–è¾‘å™¨ï¼Œå¯ä»¥çœ‹åˆ°è¯´æ˜ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³è¦é‚£äº›ä¿®æ”¹ï¼Œå°±æŠŠé‚£å‡ è¡Œåˆ æ‰ï¼Œæˆ‘ä»¬åˆ æ‰ 6 - 8 è¡Œ</p>
<pre><code class="bash">  1 # Manual hunk edit mode -- see bottom for a quick guide.
  2 @@ -4,3 +4,7 @@ line 3
  3  line 4
  4  line 5
  5  line 6
  6 +line 7
  7 # ---
  8 # To remove &#39;-&#39; lines, make them &#39; &#39; lines (context).
  9 # To remove &#39;+&#39; lines, delete them.
 10 # Lines starting with # will be removed.
 11 # If the patch applies cleanly, the edited hunk will immediatel    y be marked for staging.
 12 # If it does not apply cleanly, you will be given an opportunit    y to
 13 # edit again.  If all lines of the hunk are removed, then the e    dit is
 14 # aborted and the hunk is left unchanged.
</code></pre>
<p>ä¿å­˜é€€å‡ºä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>git status</code></p>
<pre><code class="bash">$ git status
On branch master
Changes to be committed:
  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)
        modified:   tmp.txt

Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
        modified:   tmp.txt
</code></pre>
<p>çœ‹åˆ°åªæ·»åŠ äº†ä¸€éƒ¨åˆ†çš„ä¿®æ”¹å†…å®¹ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†ä¿®æ”¹æ²¡æœ‰æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å…ˆ <code>git commit</code> ä¸€éƒ¨åˆ†äº†</p>
<blockquote>
<p>ç¬¬äº”ç« è¿˜å‰©ä¸‹è®¡ç®— SHA-1 çš„æ–¹æ³• å’Œ å…¶ä»–ä¸€äº› git åº•å±‚çš„åŸç†äº†ï¼Œåº•å±‚çš„åŸç†åœ¨ä»¥åçš„åº”ç”¨å¯èƒ½ä¸ä¼šç”¨åˆ°ï¼Œä½†æ˜¯å­¦ä¹ çš„æ—¶å€™è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹å§ï¼Œå†ä¹‹åå°±å¼€å§‹è®²åˆ†æ”¯çš„åº”ç”¨äº†ï¼Œåˆ†æ”¯æ˜¯å¿…é¡»æŒæ¡çš„é‡ç‚¹äº†</p>
</blockquote>


	<b><span id="post-date">2023/01/05</span></b>
	<div id="tags">
		<ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag"># git</a></li></ul>
	</div>

	<div id="clear"></div>
</div>
<center><a class="gobk" href="javascript:;" onclick="Gobk()">&gt CLICK TO back &lt</a><center>
<div id="cart">
	<button id="cart-hide" onclick="cartCg()">â—€</button>
</div>
<script>
	if(history.state==null){
		var tmpa=document.getElementsByClassName("gobk")[0];
		tmpa.innerHTML="> CLICK TO land <";
	}
	showAIndex();
</script>

	</div>
	<script>
		hljs.highlightAll();
		hljs.initLineNumbersOnLoad();
	</script>
</span>
	<hr id="hidden">
	

	<script>
		hljs.highlightAll();
		hljs.initLineNumbersOnLoad();
		initBg();
		$(document).pjax('a','#pup',{fragment:'#pup',timeout: 8000});
	</script>
</body>
</html>
